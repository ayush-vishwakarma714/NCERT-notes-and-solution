document.getElementById('y').textContent = new Date().getFullYear();
const nav = document.querySelector('.nav');document.querySelector('.nav-toggle').addEventListener('click',()=>nav.classList.toggle('open'));
document.getElementById('searchBtn').addEventListener('click',()=>{const q=document.getElementById('searchInput').value.trim().toLowerCase();if(!q){location.hash='#notes';return;} if(q.includes('class'))location.hash='#classes'; else location.hash='#notes';});
const tiltEls=[...document.querySelectorAll('.tilt')];tiltEls.forEach(el=>{let r;const M=10;const e=()=>{r=el.getBoundingClientRect();el.style.willChange='transform'};const l=()=>{el.style.transform='rotateX(0) rotateY(0) translateZ(0)';el.style.willChange='auto'};const m=t=>{const x=(t.clientX??(t.touches?.[0]?.clientX||0))-r.left;const y=(t.clientY??(t.touches?.[0]?.clientY||0))-r.top;const rx=((y/r.height)-.5)*-2*M;const ry=((x/r.width)-.5)*2*M;el.style.transform=`rotateX(${rx.toFixed(2)}deg) rotateY(${ry.toFixed(2)}deg) translateZ(6px)`};el.addEventListener('mouseenter',e);el.addEventListener('mousemove',m);el.addEventListener('mouseleave',l);el.addEventListener('touchstart',e,{passive:true});el.addEventListener('touchmove',m,{passive:true});el.addEventListener('touchend',l)});
(function(){const c=document.getElementById('scene');if(!c)return;const r=new THREE.WebGLRenderer({canvas:c,antialias:true,alpha:true});function setS(){const h=document.querySelector('.hero');r.setSize(window.innerWidth,h.offsetHeight);r.setPixelRatio(Math.min(window.devicePixelRatio,2))}setS();const s=new THREE.Scene();const cam=new THREE.PerspectiveCamera(45,window.innerWidth/document.querySelector('.hero').offsetHeight,.1,100);cam.position.set(4,3,7);cam.lookAt(0,.6,0);s.add(new THREE.HemisphereLight(0xbddcff,0x0b1221,.8));const d=new THREE.DirectionalLight(0xffffff,.8);d.position.set(5,8,6);s.add(d);const desk=new THREE.Mesh(new THREE.PlaneGeometry(20,10),new THREE.MeshStandardMaterial({color:0x0b1428,roughness:.8,metalness:.1}));desk.rotation.x=-Math.PI/2;desk.position.y=-.2;s.add(desk);function book(o){const g=new THREE.BoxGeometry(o.w||1.2,o.h||.2,o.d||.9);const m=new THREE.MeshStandardMaterial({color:o.color||0x1e3a8a,roughness:.6,metalness:.1});const mesh=new THREE.Mesh(g,m);mesh.position.set(o.x||0,o.y||0,o.z||0);mesh.rotation.y=o.ry||0;s.add(mesh);const gp=new THREE.BoxGeometry((o.w||1.2)*.94,(o.h||.2)*.6,(o.d||.9)*.92);const mp=new THREE.MeshStandardMaterial({color:0xf3f4f6,roughness:1,metalness:0});const pages=new THREE.Mesh(gp,mp);pages.position.set(0,(o.h||.2)*.05,0);mesh.add(pages);return mesh}const B=[book({color:0x1e3a8a,y:0,ry:.07}),book({color:0x38bdf8,y:.22,ry:-.05}),book({color:0x16a34a,y:.44,ry:.03}),book({color:0xffd166,y:.66,ry:-.02})];const P=new THREE.Group();P.add(new THREE.Mesh(new THREE.CylinderGeometry(.05,.05,1.6,12),new THREE.MeshStandardMaterial({color:0xf59e0b,roughness:.5})));const tip=new THREE.Mesh(new THREE.ConeGeometry(.06,.2,24),new THREE.MeshStandardMaterial({color:0x7f5539}));tip.position.y=-.9;P.add(tip);P.rotation.set(.1,.6,-.2);P.position.set(1.6,.2,.6);s.add(P);let t=0;function a(){requestAnimationFrame(a);t+=.01;B.forEach((b,i)=>{b.position.y=.22*i+Math.sin(t+i)*.03;b.rotation.y+=.0008*(i%2===0?1:-1)});P.position.y=.2+Math.sin(t*1.2)*.05;P.rotation.z+=.002;r.render(s,cam)}a();window.addEventListener('resize',()=>{setS();cam.aspect=window.innerWidth/document.querySelector('.hero').offsetHeight;cam.updateProjectionMatrix()});document.addEventListener('visibilitychange',()=>{r.setAnimationLoop(document.hidden?null:a)})})();